{"version":3,"sources":["../src/dragndrop.js"],"names":["init","window","console","log","dragged","document","addEventListener","event","target","style","opacity","preventDefault","className","background","parentNode","removeChild","noteid","id","replace","columnid","appendChild","promise","Ajax","call","methodname","args","newcolumnid","done","response","fail","ex"],"mappings":"ybAwBA,O,6iBAEoB,QAAPA,CAAAA,IAAO,EAAM,CACtBC,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,sBAAnB,EAEA,GAAIC,CAAAA,CAAJ,CAEAC,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,CAAuC,SAASC,CAAT,CAAgB,CACnDN,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,gBAAnB,EAGAC,CAAO,CAAGG,CAAK,CAACC,MAAhB,CACAP,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmBC,CAAnB,EAEAG,CAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA6B,EAChC,CARD,KAUAL,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,CAAqC,SAASC,CAAT,CAAgB,CAEjDA,CAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,OAAnB,CAA6B,EAChC,CAHD,KAMAL,QAAQ,CAACC,gBAAT,CAA0B,UAA1B,CAAsC,SAASC,CAAT,CAAgB,CAElDA,CAAK,CAACI,cAAN,EACH,CAHD,KAKAN,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,CAAuC,SAASC,CAAT,CAAgB,CAEnD,GAA8B,YAA1B,EAAAA,CAAK,CAACC,MAAN,CAAaI,SAAjB,CAA4C,CACxCL,CAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,UAAnB,CAAgC,MACnC,CAEJ,CAND,KAQAR,QAAQ,CAACC,gBAAT,CAA0B,WAA1B,CAAuC,SAASC,CAAT,CAAgB,CAEnD,GAA8B,YAA1B,EAAAA,CAAK,CAACC,MAAN,CAAaI,SAAjB,CAA4C,CACxCL,CAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,UAAnB,CAAgC,EACnC,CAEJ,CAND,KAQAR,QAAQ,CAACC,gBAAT,CAA0B,MAA1B,CAAkC,SAASC,CAAT,CAAgB,CAE9CA,CAAK,CAACI,cAAN,GAEA,GAA8B,YAA1B,EAAAJ,CAAK,CAACC,MAAN,CAAaI,SAAjB,CAA4C,CACxCL,CAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBI,UAAnB,CAAgC,EAAhC,CACAT,CAAO,CAACU,UAAR,CAAmBC,WAAnB,CAAgCX,CAAhC,EAFwC,GAIpCY,CAAAA,CAAM,CAAGZ,CAAO,CAACa,EAAR,CAAWC,OAAX,CAAmB,SAAnB,CAA8B,EAA9B,EAAkCA,OAAlC,CAA0C,WAA1C,CAAuD,EAAvD,CAJ2B,CAKpCC,CAAQ,CAAGZ,CAAK,CAACC,MAAN,CAAaS,EAAb,CAAgBC,OAAhB,CAAwB,QAAxB,CAAkC,EAAlC,CALyB,CAOxCX,CAAK,CAACC,MAAN,CAAaY,WAAb,CAA0BhB,CAA1B,EACA,GAAIiB,CAAAA,CAAO,CAAGC,CAAI,CAACC,IAAL,CAAU,CAAC,CACrBC,UAAU,CAAE,sCADS,CAErBC,IAAI,CAAE,CAACT,MAAM,CAAEA,CAAT,CAAiBU,WAAW,CAAEP,CAA9B,CAFe,CAAD,CAAV,CAAd,CAIAE,CAAO,CAAC,CAAD,CAAP,CAAWM,IAAX,CAAgB,SAASC,CAAT,CAAmB,CAC/B3B,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,oCAAsCyB,CAAzD,CACH,CAFD,EAEGC,IAFH,CAEQ,SAASC,CAAT,CAAa,CACjB7B,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,mCAAqC2B,CAAxD,CACH,CAJD,CAMH,CAEJ,CAxBD,IAyBH,C","sourcesContent":["\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for the drag'n'drop functionnality.\n *\n * @package   mod_stickynotes\n * @copyright 2021 SÃ©bastien Mehr <sebmehr.fr>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as Ajax from 'core/ajax';\n\nexport const init = () => {\n    window.console.log('we have been started');\n\n    let dragged;\n\n    document.addEventListener(\"dragstart\", function(event) {\n        window.console.log('Start dragging');\n\n        // store a ref. on the dragged elem\n        dragged = event.target;\n        window.console.log(dragged);\n        // make it half transparent\n        event.target.style.opacity = .5;\n    }, false);\n\n    document.addEventListener(\"dragend\", function(event) {\n        // reset the transparency\n        event.target.style.opacity = \"\";\n    }, false);\n\n    /* events fired on the drop targets */\n    document.addEventListener(\"dragover\", function(event) {\n        // prevent default to allow drop\n        event.preventDefault();\n    }, false);\n\n    document.addEventListener(\"dragenter\", function(event) {\n        // highlight potential drop target when the draggable element enters it\n        if (event.target.className == \"columnnote\") {\n            event.target.style.background = \"#eee\";\n        }\n\n    }, false);\n\n    document.addEventListener(\"dragleave\", function(event) {\n        // reset background of potential drop target when the draggable element leaves it\n        if (event.target.className == \"columnnote\") {\n            event.target.style.background = \"\";\n        }\n\n    }, false);\n\n    document.addEventListener(\"drop\", function(event) {\n        // prevent default action (open as link for some elements)\n        event.preventDefault();\n        // move dragged elem to the selected drop target\n        if (event.target.className == \"columnnote\") {\n            event.target.style.background = \"\";\n            dragged.parentNode.removeChild( dragged );\n\n            let noteid = dragged.id.replace('element', '').replace('container', '');\n            let columnid = event.target.id.replace('column', '');\n\n            event.target.appendChild( dragged );\n            var promise = Ajax.call([{\n                methodname: 'mod_stickynotes_changing_note_column',\n                args: {noteid: noteid, newcolumnid: columnid},\n            }]);\n            promise[0].done(function(response) {\n                window.console.log('mod_stickynotes/dragndrop success' + response);\n            }).fail(function(ex) {\n                window.console.log('mod_stickynotes/dragndrop erreur' + ex);\n            });\n\n        }\n\n    }, false);\n};"],"file":"dragndrop.min.js"}